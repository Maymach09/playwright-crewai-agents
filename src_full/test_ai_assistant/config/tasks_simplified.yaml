plan_test_task:
  description: >
    You are a test planner. Create a comprehensive test plan for the given scenario.

    **Input**: {user_input}
    **Context**: {context}

    **Instructions**:
    1. Run `planner_setup_page` with project="chromium" and seedfile="tests/seed.spec.ts"
    2. Explore the application using browser_snapshot and browser_navigate
    3. Identify test scenarios based on user input
    4. Create a detailed test plan with steps and expected results
    5. Save to test_plan/ directory

    **Output Format**: Markdown file with clear scenario sections, numbered steps, and expected results.

  expected_output: >
    A detailed test plan markdown file saved to test_plan/<timestamp>_test-plan.md

generate_test_task:
  description: >
    You are a Playwright test generator. Generate executable test scripts from the test plan.

    **Input**: 
    - Scenarios to generate: {user_input}
    - Test plan: {context}

    **Workflow for EACH scenario**:
    1. Run `generator_setup_page` (project="chromium", seedFile="tests/seed.spec.ts")
    2. Execute each test step using browser_click, browser_type, browser_fill_form
    3. Verify results with browser_verify_* tools
    4. Run `generator_read_log` to capture the recorded actions
    5. Run `generator_write_test` with proper TypeScript code

    **Code Structure**:
    ```typescript
    // seed: tests/seed.spec.ts
    import { test, expect } from '@playwright/test';
    
    test.describe('Scenario Name', () => {
      test('test name', async ({ page }) => {
        // Step 1: Description
        await page.action();
        await expect(page).assertion();
      });
    });
    ```

    **Rules**:
    - Use Playwright best practices
    - Include proper assertions after each step
    - Use reliable locators (getByRole, getByText)
    - One test file per scenario

  expected_output: >
    Valid Playwright test files saved to tests/ directory with proper structure and assertions.

heal_test_task:
  description: >
    You are a test healer. Debug and fix failing Playwright tests.

    **Context**: {context}

    **Workflow**:
    1. Run `playwright_test_run_test` to identify failures
    2. For each failing test, run `playwright_test_debug_test`
    3. Use browser tools to investigate issues
    4. Fix the test code
    5. Re-run until all tests pass

    **Focus on**:
    - Updated selectors
    - Timing issues
    - Assertion corrections
    - Test reliability

  expected_output: >
    Fixed test files with detailed report of changes made.
